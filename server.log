Google OAuth not configured. Set GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET
2025-06-21 19:26:07 - main - INFO - Successfully connected to AWS S3 bucket: mystorybuddy-assets
INFO:     Started server process [83716]
INFO:     Waiting for application startup.
2025-06-21 19:26:07 - main - INFO - Starting My Story Buddy API...
2025-06-21 19:26:07 - database - INFO - Initializing database connection pool...
2025-06-21 19:26:07 - database - INFO - Connecting to database at database-1.cbuyybcooluu.us-west-2.rds.amazonaws.com:3306
2025-06-21 19:26:08 - database - INFO - Database connectivity test successful: (1,)
2025-06-21 19:26:08 - database - INFO - Database connection pool initialized successfully!
2025-06-21 19:26:08 - database - INFO - Creating database tables...
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'stories' already exists
  await self._query(query)
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'fun_facts' already exists
  await self._query(query)
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'user_sessions' already exists
  await self._query(query)
2025-06-21 19:26:10 - database - INFO - Database tables created successfully!
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'users' already exists
  await self._query(query)
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'user_otps' already exists
  await self._query(query)
/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/venv/lib/python3.11/site-packages/aiomysql/cursors.py:239: Warning: Table 'user_auth_sessions' already exists
  await self._query(query)
2025-06-21 19:26:11 - main - INFO - Database initialized successfully!
2025-06-21 19:26:11 - main - INFO - My Story Buddy API is ready!
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8003 (Press CTRL+C to quit)
2025-06-21 19:26:25 - email_service - ERROR - SES error (AccessDenied): An error occurred (AccessDenied) when calling the SendEmail operation: User `arn:aws:iam::926211191776:user/mystorybuddy-s3-uploader' is not authorized to perform `ses:SendEmail' on resource `arn:aws:ses:us-west-2:926211191776:identity/noreply@mystorybuddy.com'
2025-06-21 19:26:26 - auth_routes - INFO - User signup successful: fixeduser@example.com
INFO:     127.0.0.1:55765 - "POST /auth/signup HTTP/1.1" 201 Created
2025-06-21 19:27:28 - auth_routes - INFO - User login successful: fixeduser@example.com
INFO:     127.0.0.1:56048 - "POST /auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:56227 - "GET /auth/google/ HTTP/1.1" 503 Service Unavailable
2025-06-21 19:28:03 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81
2025-06-21 19:28:03 - main - INFO - Request Method: GET
2025-06-21 19:28:03 - main - INFO - Request URL: http://127.0.0.1:8003/.well-known/appspecific/com.chrome.devtools.json
2025-06-21 19:28:03 - main - INFO - Request Headers: {'host': '127.0.0.1:8003', 'connection': 'keep-alive', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'no-cors', 'sec-fetch-dest': 'empty', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}
2025-06-21 19:28:03 - main - INFO - Request Client: 127.0.0.1
2025-06-21 19:28:03 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting story generation
2025-06-21 19:28:03 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Prompt: ...
2025-06-21 19:28:03 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Using default prompt
2025-06-21 19:28:03 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Generating story with GPT-4.1...
2025-06-21 19:28:03 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71
2025-06-21 19:28:03 - main - INFO - Request Method: GET
2025-06-21 19:28:03 - main - INFO - Request URL: http://127.0.0.1:8003/favicon.ico
2025-06-21 19:28:03 - main - INFO - Request Headers: {'host': '127.0.0.1:8003', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"macOS"', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"', 'sec-ch-ua-mobile': '?0', 'accept': 'image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'no-cors', 'sec-fetch-dest': 'image', 'referer': 'http://127.0.0.1:8003/auth/google/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}
2025-06-21 19:28:03 - main - INFO - Request Client: 127.0.0.1
2025-06-21 19:28:03 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting story generation
2025-06-21 19:28:03 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Prompt: ...
2025-06-21 19:28:03 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Using default prompt
2025-06-21 19:28:03 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generating story with GPT-4.1...
2025-06-21 19:28:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:09 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Story generated successfully in 6.69 seconds
2025-06-21 19:28:09 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Title: Bella Bunny and the Rainbow Slide
2025-06-21 19:28:09 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generating 4 comic images...
2025-06-21 19:28:09 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Breaking down story into 4 comic parts...
2025-06-21 19:28:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:10 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Story generated successfully in 7.07 seconds
2025-06-21 19:28:10 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Title: Daisy Duckâ€™s Rainbow Boots
2025-06-21 19:28:10 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Generating 4 comic images...
2025-06-21 19:28:10 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Breaking down story into 4 comic parts...
2025-06-21 19:28:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:13 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Story breakdown completed in 3.32 seconds
2025-06-21 19:28:13 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Successfully created 4 story parts for comic generation
2025-06-21 19:28:13 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Generating character consistency guide...
2025-06-21 19:28:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:13 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Story breakdown completed in 3.50 seconds
2025-06-21 19:28:13 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Successfully created 4 story parts for comic generation
2025-06-21 19:28:13 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generating character consistency guide...
2025-06-21 19:28:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Character guide generated in 5.60 seconds
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Generating 4 comic images in parallel...
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting generation for image 1/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting generation for image 2/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting generation for image 3/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting generation for image 4/4...
2025-06-21 19:28:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Character guide generated in 5.74 seconds
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generating 4 comic images in parallel...
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting generation for image 1/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting generation for image 2/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting generation for image 3/4...
2025-06-21 19:28:19 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting generation for image 4/4...
INFO:     127.0.0.1:56416 - "OPTIONS /auth/signup HTTP/1.1" 200 OK
2025-06-21 19:28:48 - email_service - ERROR - SES error (AccessDenied): An error occurred (AccessDenied) when calling the SendEmail operation: User `arn:aws:iam::926211191776:user/mystorybuddy-s3-uploader' is not authorized to perform `ses:SendEmail' on resource `arn:aws:ses:us-west-2:926211191776:identity/noreply@mystorybuddy.com'
2025-06-21 19:28:49 - auth_routes - INFO - User signup successful: manish_jain1@hotmail.com
INFO:     127.0.0.1:56416 - "POST /auth/signup HTTP/1.1" 201 Created
INFO:     127.0.0.1:56416 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:56416 - "GET /auth/me HTTP/1.1" 200 OK
2025-06-21 19:29:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 200 OK"
2025-06-21 19:29:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 200 OK"
2025-06-21 19:29:14 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting S3 upload
2025-06-21 19:29:14 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generated object key: stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_1.png
2025-06-21 19:29:15 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting S3 upload
2025-06-21 19:29:15 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generated object key: stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_4.png
2025-06-21 19:29:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 200 OK"
2025-06-21 19:29:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 400 Bad Request"
2025-06-21 19:29:21 - main - ERROR - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Error generating image 2: Error code: 400 - {'error': {'message': 'Request was rejected as a result of the safety system. Request may contain content that is not allowed by the safety system.', 'type': 'image_generation_user_error', 'param': None, 'code': 'moderation_blocked'}}
2025-06-21 19:29:21 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting S3 upload
2025-06-21 19:29:21 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generated object key: stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_2.png
2025-06-21 19:29:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 400 Bad Request"
2025-06-21 19:29:22 - main - ERROR - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Error generating image 1: Error code: 400 - {'error': {'message': 'Request was rejected as a result of the safety system. Request may contain content that is not allowed by the safety system.', 'type': 'image_generation_user_error', 'param': None, 'code': 'moderation_blocked'}}
2025-06-21 19:29:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 200 OK"
2025-06-21 19:29:25 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 400 Bad Request"
2025-06-21 19:29:25 - main - ERROR - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Error generating image 3: Error code: 400 - {'error': {'message': 'Request was rejected as a result of the safety system. Request may contain content that is not allowed by the safety system.', 'type': 'image_generation_user_error', 'param': None, 'code': 'moderation_blocked'}}
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image saved to S3: https://mystorybuddy-assets.s3.amazonaws.com/stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_1.png?AWSAccessKeyId=AKIA5PJT5GPQJKCNPLPZ&Signature=QxftgjgSBG0b6DNI%2F2EyrJFVQ%2Fw%3D&Expires=1750517966
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - S3 upload completed in 11.21 seconds
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image 1/4 generated and saved successfully
2025-06-21 19:29:26 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Starting S3 upload
2025-06-21 19:29:26 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Generated object key: stories/5a502872-4120-469a-80fd-43471ce43d81_image_4.png
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image saved to S3: https://mystorybuddy-assets.s3.amazonaws.com/stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_4.png?AWSAccessKeyId=AKIA5PJT5GPQJKCNPLPZ&Signature=117a1oSUBRWkNYk5Bh5MufSAZmw%3D&Expires=1750517966
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - S3 upload completed in 11.60 seconds
2025-06-21 19:29:26 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image 4/4 generated and saved successfully
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Image saved to S3: https://mystorybuddy-assets.s3.amazonaws.com/stories/5a502872-4120-469a-80fd-43471ce43d81_image_4.png?AWSAccessKeyId=AKIA5PJT5GPQJKCNPLPZ&Signature=VevgHhUXPiC8Lv%2B0U60KReQc4oI%3D&Expires=1750517968
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - S3 upload completed in 1.85 seconds
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Image 4/4 generated and saved successfully
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - All 4 images generated in parallel in 69.26 seconds
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Successfully generated 1/4 images
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - All 4 images generated successfully in 78.18 seconds
2025-06-21 19:29:28 - main - ERROR - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Failed to save story to database: 'Depends' object is not subscriptable
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Story generation completed successfully in 85.25 seconds
2025-06-21 19:29:28 - main - INFO - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Performance metrics:
2025-06-21 19:29:28 - main - INFO -   - Story generation: 7.07s
2025-06-21 19:29:28 - main - INFO -   - Images generation: 78.18s
2025-06-21 19:29:28 - main - INFO -   - Total time: 85.25s
2025-06-21 19:29:28 - main - ERROR - Request ID: 5a502872-4120-469a-80fd-43471ce43d81 - Error occurred
2025-06-21 19:29:28 - main - ERROR - Error Type: TypeError
2025-06-21 19:29:28 - main - ERROR - Error Message: 'Depends' object is not subscriptable
2025-06-21 19:29:28 - main - ERROR - Traceback: Traceback (most recent call last):
  File "/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/main.py", line 595, in generate_story
    "id": current_user["id"],
          ~~~~~~~~~~~~^^^^^^
TypeError: 'Depends' object is not subscriptable

INFO:     127.0.0.1:56227 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 500 Internal Server Error
2025-06-21 19:29:33 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image saved to S3: https://mystorybuddy-assets.s3.amazonaws.com/stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_2.png?AWSAccessKeyId=AKIA5PJT5GPQJKCNPLPZ&Signature=%2BPzZFJoU38M%2B6GtDsT%2BOoxcbJYo%3D&Expires=1750517973
2025-06-21 19:29:33 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - S3 upload completed in 11.37 seconds
2025-06-21 19:29:33 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image 2/4 generated and saved successfully
2025-06-21 19:30:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 500 Internal Server Error"
2025-06-21 19:30:04 - openai._base_client - INFO - Retrying request to /images/generations in 0.972340 seconds
2025-06-21 19:31:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/images/generations "HTTP/1.1 200 OK"
2025-06-21 19:31:06 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Starting S3 upload
2025-06-21 19:31:06 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Generated object key: stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_3.png
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image saved to S3: https://mystorybuddy-assets.s3.amazonaws.com/stories/70ffc4ed-8f68-4483-b597-326a2b05fe71_image_3.png?AWSAccessKeyId=AKIA5PJT5GPQJKCNPLPZ&Signature=cJQpnID3R9nS7qhTcMIlFEl6Lpw%3D&Expires=1750518078
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - S3 upload completed in 11.82 seconds
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Image 3/4 generated and saved successfully
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - All 4 images generated in parallel in 179.25 seconds
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Successfully generated 4/4 images
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - All 4 images generated successfully in 188.49 seconds
2025-06-21 19:31:18 - main - ERROR - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Failed to save story to database: 'Depends' object is not subscriptable
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Story generation completed successfully in 195.18 seconds
2025-06-21 19:31:18 - main - INFO - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Performance metrics:
2025-06-21 19:31:18 - main - INFO -   - Story generation: 6.69s
2025-06-21 19:31:18 - main - INFO -   - Images generation: 188.49s
2025-06-21 19:31:18 - main - INFO -   - Total time: 195.18s
2025-06-21 19:31:18 - main - ERROR - Request ID: 70ffc4ed-8f68-4483-b597-326a2b05fe71 - Error occurred
2025-06-21 19:31:18 - main - ERROR - Error Type: TypeError
2025-06-21 19:31:18 - main - ERROR - Error Message: 'Depends' object is not subscriptable
2025-06-21 19:31:18 - main - ERROR - Traceback: Traceback (most recent call last):
  File "/Users/manishjain/Desktop/repos/my-story-buddy/my-story-buddy-backend/main.py", line 595, in generate_story
    "id": current_user["id"],
          ~~~~~~~~~~~~^^^^^^
TypeError: 'Depends' object is not subscriptable

INFO:     127.0.0.1:59203 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:59204 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:59204 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:59203 - "GET /auth/me HTTP/1.1" 200 OK
2025-06-21 20:04:08 - database - ERROR - Database operation error: (2013, 'Lost connection to MySQL server during query ([Errno 54] Connection reset by peer)')
INFO:     127.0.0.1:61525 - "GET /auth/me HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:61530 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64325 - "OPTIONS /generateFunFacts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64326 - "OPTIONS /generateStory HTTP/1.1" 200 OK
INFO:     127.0.0.1:64326 - "POST /generateFunFacts HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:64325 - "POST /generateStory HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:49435 - "OPTIONS /auth/login HTTP/1.1" 200 OK
2025-06-23 19:28:32 - auth_routes - INFO - User login successful: manish_jain1@hotmail.com
INFO:     127.0.0.1:49435 - "POST /auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:49435 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:49435 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:49515 - "OPTIONS /generateFunFacts HTTP/1.1" 200 OK
INFO:     127.0.0.1:49516 - "OPTIONS /generateStory HTTP/1.1" 200 OK
2025-06-23 19:28:51 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78
2025-06-23 19:28:51 - main - INFO - Request Method: POST
2025-06-23 19:28:51 - main - INFO - Request URL: http://127.0.0.1:8003/generateFunFacts
2025-06-23 19:28:51 - main - INFO - Request Headers: {'host': '127.0.0.1:8003', 'connection': 'keep-alive', 'content-length': '25', 'sec-ch-ua-platform': '"macOS"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo2LCJlbWFpbCI6Im1hbmlzaF9qYWluMUBob3RtYWlsLmNvbSIsImF1dGhfdHlwZSI6ImVtYWlsX3Bhc3N3b3JkIiwiZXhwIjoxNzUzMjc5MTEwfQ.QdbcCAvJ5WGzBFSMsXOgEyzJSF05Ibu8DVAKAzQeqf8', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'cross-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}
2025-06-23 19:28:51 - main - INFO - Request Client: 127.0.0.1
2025-06-23 19:28:51 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Starting fun facts generation
2025-06-23 19:28:51 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Prompt: monkey (dev)...
2025-06-23 19:28:51 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Generating fun facts with GPT-4.1...
2025-06-23 19:28:53 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2
2025-06-23 19:28:53 - main - INFO - Request Method: POST
2025-06-23 19:28:53 - main - INFO - Request URL: http://127.0.0.1:8003/generateStory
2025-06-23 19:28:53 - main - INFO - Request Headers: {'host': '127.0.0.1:8003', 'connection': 'keep-alive', 'content-length': '63', 'sec-ch-ua-platform': '"macOS"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo2LCJlbWFpbCI6Im1hbmlzaF9qYWluMUBob3RtYWlsLmNvbSIsImF1dGhfdHlwZSI6ImVtYWlsX3Bhc3N3b3JkIiwiZXhwIjoxNzUzMjc5MTEwfQ.QdbcCAvJ5WGzBFSMsXOgEyzJSF05Ibu8DVAKAzQeqf8', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'cross-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}
2025-06-23 19:28:53 - main - INFO - Request Client: 127.0.0.1
2025-06-23 19:28:53 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Starting story generation
2025-06-23 19:28:53 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Prompt: monkey (dev)...
2025-06-23 19:28:53 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Using custom prompt
2025-06-23 19:28:53 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Generating story with GPT-4.1...
2025-06-23 19:28:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-23 19:28:57 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Fun facts generated successfully in 5.94 seconds
2025-06-23 19:28:57 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Parsed 10 fun facts successfully
2025-06-23 19:28:58 - database - INFO - Fun facts saved successfully for request_id: 47e80868-3db2-4919-94d6-d11cc07cba78
2025-06-23 19:29:01 - main - INFO - Request ID: 47e80868-3db2-4919-94d6-d11cc07cba78 - Fun facts saved to database with ID: 12
INFO:     127.0.0.1:49515 - "POST /generateFunFacts HTTP/1.1" 200 OK
2025-06-23 19:29:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Story generated successfully in 12.04 seconds
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Title: Dev the Monkey and the Banana Balloon
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Generating 4 comic images...
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Dev mode detected, returning static test images
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Returning 4 static dev images
2025-06-23 19:29:05 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - All 4 images generated successfully in 0.00 seconds
2025-06-23 19:29:07 - database - INFO - Story saved successfully for request_id: 3a9bf484-cedc-4ddc-ae8d-af45417692b2
2025-06-23 19:29:08 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Story saved to database with ID: 12
2025-06-23 19:29:08 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Story generation completed successfully in 15.16 seconds
2025-06-23 19:29:08 - main - INFO - Request ID: 3a9bf484-cedc-4ddc-ae8d-af45417692b2 - Performance metrics:
2025-06-23 19:29:08 - main - INFO -   - Story generation: 12.04s
2025-06-23 19:29:08 - main - INFO -   - Images generation: 0.00s
2025-06-23 19:29:08 - main - INFO -   - Total time: 15.16s
INFO:     127.0.0.1:49516 - "POST /generateStory HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:60092 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:60092 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "OPTIONS /auth/logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "POST /auth/logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "OPTIONS /auth/login HTTP/1.1" 200 OK
2025-06-23 20:07:20 - auth_routes - INFO - User login successful: manish_jain1@hotmail.com
INFO:     127.0.0.1:60091 - "POST /auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:60091 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53709 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53710 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53709 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53710 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62290 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62291 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62290 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62291 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64128 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64129 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64185 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64186 - "GET /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54741 - "OPTIONS /auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "OPTIONS /auth/me HTTP/1.1" 200 OK
2025-06-24 10:46:12 - database - ERROR - Database operation error: (2013, 'Lost connection to MySQL server during query ([Errno 54] Connection reset by peer)')
INFO:     127.0.0.1:54742 - "GET /auth/me HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:54741 - "GET /auth/me HTTP/1.1" 200 OK
